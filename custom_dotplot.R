# Dotplot try

library(dotplot)
library(biostrings)
library(ggplot2)
seq1 = 'AGCAGCTGCTGATCTCATGCCAGGCTGCTGATGGGCACTCAGTAAATGGAGAATAAAGGAAGAAATCCATGCCCAGTGGTGATTCAGCTCCTTATGCTCTTTCCACAGTGCTCAGCAGCCCCCTGCCATCCCATGCCTGGGAAGTTGTTCTTGCTACTTTTAATATTACTGTTTCCTCCCTGAAAATCACTCCCACTTCTCCTACTGCATCCCTTTAGATCCTCAGAAGCCCTCGTCCCACTGAAATCTGCTTTCTTAAATTATTCTTTTTCTTTTGGCTAGATTCCCTCCCTTTCTCTGAAGTGGCTGGGGCACTTTTGCCAAGGCTGTCGTCCCACTTGAAATGTCAGCAGATATGGCCGGGCACAGTGGCCCACGTCTGTAATCCCAGCACTTTGGGAGGCCGAGATGGGCGGATCACTTGAGGTCAGGAGTTTGAGACTAGCCTGGCCAACATGGTGAAACCCTGTCTCTACTAAAAATACAACAAATTAGCCAGGTGTGGTAGCTCTTGCCTGTAGTCCCAGCTACTTGGGAGGCTGAGGCAGGAGAATTGCTTGAACCTGAGAGGCCTGGGCGACAGAGTGAGACTCTGTCTCAAAAAAAAAAAAAAAAAAAAAAGTCAGCACATTCACCCATAAGTGCTCAAGATGGGAGGCTCCTTAAAGACCATGTCTCCCCAGCTTCCTGAGCTTCCTGAGGGGCCCTTGTCTACCTTGGACACCACTAGTTGTTGGTTCTTTCTGCCACTGAGCCAAGAATCAGTCTACTCAAAGCTGTCCCCAGAGGCTCCTGGTTCCTGTCCTGTGGCCTTATGGCAAATCTGCACCCTCTCTTCCTTGTGACCTCCCAGCCAGGGGTAGACCGGTCCTGCCCTGCTCAGTGGAGGGACCGCAGGCCTTGGGGTCAGACTCAGCTAAGTTCAAAGCCGCGTTTCTCCATTTGCTAGTGGTGTCGCTTTTTTAGGCATGGTCTGTTATTTTACCTGCTTCCTCATCTGTAAAGCAGGGTTCCTATTACCTACTTTGTTGGGACATCCAGAGAATGCAATAAAATGGCATAAAGGGGCTGGGCACGGTGGCTCACGCCTGTAATCCCAGCACTTTGGGAGGCCGAGGCGGGGGGATCACGAGGTCAGGAAATCGAGACCATCCTGGCTAACATGGTGAAACCCCGTCTCTACTAAAAATACAAAATTAGCCAGGCATGGTGGCGCATGCCTGTAATCCCAGCTACTCAGGAGGCTGAAGCAGGAAAATCACTTGAACCCTGGTAGCAGAGGTTACAGTGAGCCGAGACAATGCCATTGCACTCCAGCCTGGGCAACAAGAGTGAAACTCCATCTCAAAAAAAAGAAAACAGAGTTGAAAGAGAGTCCAGGACAGACTGACTGTCCTGTGTGAACATCCCTGCAGGAGATTTGGACAGGACTTAGTGCTATTCCAACTGGAAGTGGAATATATGGGTCTGGGTAGAGCTCAGGGGACTGATCTGGGCCAGAGATGGAGATGTGGGCCTCCCCACCGTGTGGGAGAGCTGACGCTGGGGAGAGGTGAGCTCATCCCTCGCTGGGCTCATCTCCTTCCTGATCACATGGGCACCTACGGTCCACACTACACAGCTCACGCTTGCTTCTATTCAGTCTCTGCCGCCTCATTTGTGGCTCACCTTCATTCTGAGTGCATCTCTGTCCAACAACACTGCAGGCAGAAGCTGCCCCGTATTTCTCATTCTTTTCCCACACCTTGCACTCAGGGTCTGTTGACTACTAAGCTTGATGGTGATGAGAATAAACAACCACTAGGAATAGTGTCTGTTATGTACAAGGCCTAATGTTAAGCCTTTATGCCTTTTTTGTTTGTTTGTTTTTGGTTTTTGAGACAGAGTCTCGCTCTGTCCCCCAGGCTGGAGTGCAGTGGCGCGATCTCGGCTCACTGCAAGCTCCGCCTCCCGGGTTCGCGCCATTCTCCTGCCTCAGCCTCCCGAGCCACCATGCCCGGCCTCAACTCTCGTTTTCTAACCAGCTACCAAAACCTATTAATTCAACCTCTTAAGTCGCTCTCAGATTTATCTATTTCCCTCTAACCCTTCCACCTTTACAATGTCCTCATCACATCTTTTCTAAATGGCTGCTGCACCCTTCAAGCTCATCTGCTGGTCTGCAGAGCAGGTCTTGTTTCTCCCGGTGTGTTGTATTAAGGAGATCTTTCTGAAATATGTCGTCTCACTTCTCTGCCTAGGTCCCTTCGCCAGCTCCCCTGTCTCTCAGGACAGAGTGTGCAGTCCTTGCTCTGGCTCACAGTGGTAACAGTAACAGCTACGAGGTTCCTCAGGGCCTAGACTCTTCCTCCGCTCCCACTGGCACTCACCATCCCCATGGTCTCCAGCTGCACTGAGCCCTGTGTGGTTCTTGGCATCAGCCACATTCTCCCTTATCTCTCTTATCTCCCTTATCTCATGCTACTTCCTATGCCCAGAACATCCATCCTTGTCAGATGTCTTCAGTATGCCACTCAGGTGTCATTCCCTTTGGGACATCTTCTTGGACACCTCTTCCTGCAGGGTGGACATCCCTCCTGTGTGCACCAGTGCAACCTGTCATGCTGTGTGGCGATGGTCTGCTTGTCTCCCCTACTGGCCTTAGCGTTCCTGTATAGGTTGGGACCCAACCTAGGTTCATGCTGTACCTAGGACACGAACTAGTAGGAAGTTAATAAAAGCCAGATGTATGGATGGTTGGGAAGATGGGATCTGAGTAGGGCCCTGAGATATGGCCTGAGTCAGATGATGGGGTTTAGAAACCTGACCTCTTCTCAGCCGATATGTGTGCATTGGACGAGTGACTTAACCCTCACTCACGCACTGAACCAACCTTTATCGAGGGTCCGCCGCATGCCAGGGTGCTGGATACTGCAACAATGAGTCCGGCGGCTCGGGTCTTTGTCCTCCTGGAGCTCTCATTCGAATGTGGTACAGAGACATTTGCTGCAGGTAATAGTG'
seq2 = 'gtaggggagacaagcagaccatcgccacacagcatgacaggttgcactggtgcacacaggagggatgtccaccctgcaggaagaggtgtccaagaagatgtcccaaagggaatgacacctgagtggcatactgaagacatctgacaaggatggatgttctgggcataggaagtagcatgagataagggagataagagagataagggagaatgtggctgatgccaagaaccacacagggctcagtgcagctggagaccatggggatggtgagtgccagtgggagcggaggaagagtctaggccctgaggaacctcgtagctgttactgttaccactgtgagccagagcaaggactgcacactctgtcctgagagacaggggagctggcgaagggacctaggcagagaagtgagacgacatatttcagaaagatctccttaatacaacacaccgggagaaacaagacctgctctgcagaccagcagatgagcttgaagggtgcagcagccatttagaaaagatgtgatgaggacattgtaaaggtggaagggttagagggaaatagataaatctgagagcgacttaagaggttgaattaataggttttggtagctggttagaAAACGAGAGTTGAggccgggcatggcggctcatgcctgtaatcccagcactctgggagaccaaggcagacagatcacttgaggtcaggagtttgagaccagtctggccaacatggtgaaaccctgtctctactaaaaatacaaaaattaaccgggcatagtggcgggcacctgtaatcccagctacttgggaagctgagccacaagaatcgcttgaacctgagaggcagaggttgcggtgtgccaagatcgcgccactgcactccagcctgggcaggcgacagagtgagactccgtctcaaaaaaagaGGCCTGGCATGGTGGctcagcaccttgggaggccgaggcgggcagatcacctgaggtcaggagttcgaaaccagcctgaccaacatggtgaaaccccgtctctactaaaaatacaaaattagccaggcatggtggcgcatgcctgtaatcccagctactcaggaggctgaagcaggaaaatcacttgaaccctggtagcagaggttacagtgagccgagacaatgccattgcactccagcctgggcaacaagagtgaaactccatctcaaaaaaaagaaaaCAGAGTTGAAAGAGAGTCCAGGACAGACTGACTGTCCTGTGTGAACATCCCTGCAGGAGATTTGGACAGGACTTAGTGCTATTCCAACTggaagtggaatatatgggtctgggtagagctcaggggactgatctgggccagagatggagatgtgggcctccccaccgtgtggGAGAGCTGACGCTGGGGAGAGGTGAGCTCATCCCTCGCTGGGCTCATCTCCTTCCTGATCACATGGGCACCTACGGTCCACACTACACAGCTCACGCTTGCTTCTATTCAGTCTCTGCCGCCTCATTTGTGGCTCACCTTCATTCTGAGTGCATCTCTGTCCAACAACACTGCAGGCAGAAGCTGCCCCGTATTTCTCATTCTTTTCCCACACCTTGCACTCAGGGTCTGTTGACTACTAAGCTTGATGGTGATGAGaataaacaaccactaggaatagtgtctgttatgtacaaggcctaatgttaagcctttatgccttttttgtttgtttgtttttggtttttgagacagagtctcgctctgtcccccaggctggagtgcagtggcgcgatctcggctcaccgcaagctccgcctcccgggttcgcgccattctcctgcctcagcctcccgagccaccatgcccggctaattttttgtatttttagtagagacggggtttcaccatgttagccaggatggtctcgatttcctgacctcgtgatccccccgcctcggcctcccaaagtgctgggattacaggcgtgagccaccgtgcccagcccctttatgccattttattgcattctctggatgtcccaacaaagtaggtaataggaaccctgctttacagatgaggaagcaggtaaaataacagaccatgcctaaaaagcgacaccactagcaaatggagaaacgcggctttgaacttagctgagtctgaccccaaggcctgcggtccctccactgAGCAGGGCAGGACCGGTCTACCCTGGCTgggaggtcacaaggaagagagggtgcagatttgccataaggccacaggacaggaaccaggagcctctggggacagctttgagtagactgattcttggctcagtggcagaaagaaccaacaactagtggtgtccaaggtagacaagggcccctcaggaagctcaggaagctGGGGAGACATGGTCTTTAAGGAGCCTCCCATCTTGAGCACTTATGGGTGAATGTGCTGACtttttttttttttttttttttgagacagagtctcactctgtcgcccaggcctctcaggttcaagcaattctcctgcctcagcctcccaagtagctgggactacaggcaagagctaccacacctggctaatttgttgtatttttagta'

seq1r = as.character(reverseComplement(DNAString(seq1)))
seq2r = as.character(reverseComplement(DNAString(seq2)))

toplim = 3000
#dotPlotg(toupper(seq1), toupper(seq2), wsize = 100, xlab="Sequence 1", ylab="Sequence 2", main="Traditional R Graphics")
dotPlotg(seq1, seq2, wsize=8) + theme_bw() + labs(x="Sequence 1", y = "Sequence 2", title="New ggplot version") + 
  xlim(c(0,toplim))+ ylim(c(0,toplim)) 
dotPlotg(seq1, seq2r, wsize=8) + theme_bw() + labs(x="Sequence 1", y = "Sequence 2", title="New ggplot version") + 
  xlim(c(0,toplim))+ ylim(c(0,toplim))
  


dotPlotr <- function(seq1, seq2, wsize = 10, wstep = 1, nmatch = -1){
  if (length(seq1[1]) > 1)
    stop("seq1 should be provided as a single string")
  if (length(seq2[1]) > 1)
    stop("seq2 should be provided as a single string")
  if (wsize < 1)
    stop("non allowed value for wsize")
  if (wstep < 1)
    stop("non allowed value for wstep")
  if (nmatch < 1)
    nmatch = wsize
  if (nmatch > wsize)
    stop("nmatch > wsize is not allowed")
  
  library(biostrings)
  seq2r = as.character(reverseComplement(DNAString(seq2)))
  
  p1 = mkDotPlotDataFrame(seq1, seq2, wsize, wstep, nmatch)
  p2 = mkDotPlotDataFrame(seq1, seq2r, wsize, wstep, nmatch)
  
  p2$y = nchar(seq2r) - p2$y
  
  ggplot() + geom_point(data=p1, aes(x=x,y=y), shape=15) + 
    geom_point(data=p2, aes(x=x,y=y), shape=15) + 
    labs(x='Seq1', y='Seq2')
}
